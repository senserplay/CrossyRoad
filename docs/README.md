# Crossy Road AI

Проект представляет собой браузерную версию игры в стиле Crossy Road с обучающимся ИИ на основе Deep Q-Learning.

## Описание проекта

Проект состоит из двух основных частей:
1. Браузерная игра на JavaScript
2. Python-сервер с нейронной сетью для обучения ИИ

### Игровая механика
- Игрок может двигаться вверх, вниз и вправо
- За каждый шаг вправо начисляется 10 очков
- Каждую секунду счёт уменьшается на 1 очко
- При столкновении с машиной игра заканчивается
- Мир процедурно генерируется по мере продвижения вправо
- Игрок всегда находится в первой трети экрана, мир движется вместе с ним

### Искусственный интеллект
- Использует архитектуру Deep Q-Network (DQN)
- Реализован на PyTorch
- Получает информацию о состоянии игры через веб-интерфейс
- Может сохранять и загружать обученную модель
- Использует ε-жадную стратегию для исследования среды

## Установка и запуск

### Требования
- Python 3.10 или выше
- Node.js и npm (для локального веб-сервера)
- Современный веб-браузер

### Установка зависимостей

1. Установите Python-зависимости:
```bash
pip install -r requirements.txt
```

### Запуск

1. Запустите Python-сервер:
```bash
python server.py
```

2. Откройте файл index.html в браузере или запустите локальный веб-сервер:
```bash
python -m http.server 8000
```
И откройте http://localhost:8000 в браузере.

## Управление ИИ
- Кнопка "Сохранить модель" - сохраняет текущее состояние нейронной сети
- Кнопка "Загрузить модель" - загружает ранее сохранённую модель

## Система очков
- +10 очков за каждый шаг вправо
- -1 очко каждую секунду
- -100 очков при столкновении с машиной
- Счёт не может стать отрицательным

## Технические детали

### Структура проекта
- `server.py` - Python-сервер с реализацией DQN
- `game.js` - Основная логика игры
- `neural_agent.js` - Клиентская часть ИИ
- `index.html` - Веб-интерфейс игры
- `requirements.txt` - Python-зависимости

### Параметры нейронной сети
- Входной слой: 8 нейронов (позиция игрока + информация о ближайших машинах)
- Скрытый слой: 64 нейрона
- Выходной слой: 3 нейрона (вверх, вниз, вправо)
- Функция активации: ReLU
- Оптимизатор: Adam
- Learning rate: 0.001
- Discount factor (γ): 0.99
- Размер батча: 32
- Размер буфера воспроизведения: 10000
 